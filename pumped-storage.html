<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Pumped Storage Hydropower Calculator</title>
    <link rel="stylesheet" href="pumped-storage-styles.css">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>
<body>
    <div class="container">
        <header>
            <h1>Pumped Storage Hydropower Calculator</h1>
            <p>Design and analyze pumped storage facilities with detailed calculations</p>
        </header>

        <nav class="calculator-nav">
            <div class="nav-buttons">
                <a href="index.html" class="nav-btn">Basic Hydropower</a>
                <button class="nav-btn active">Pumped Storage</button>
            </div>
        </nav>

        <div class="calculator-section">
            <!-- Unit System Selection -->
            <div class="unit-selector">
                <h2>Select Unit System</h2>
                <div class="unit-toggle">
                    <label class="toggle-container">
                        <input type="radio" name="unitSystem" value="si" id="siUnits" checked>
                        <span class="toggle-checkmark"></span>
                        <strong>Metric (SI)</strong>
                    </label>
                    <label class="toggle-container">
                        <input type="radio" name="unitSystem" value="imperial" id="imperialUnits">
                        <span class="toggle-checkmark"></span>
                        <strong>Imperial (US)</strong>
                    </label>
                </div>
            </div>

            <!-- Calculation Instructions -->
            <div class="instructions-section">
                <h3>üìã How to Use</h3>
                <p><strong>Flexible Calculation:</strong> Provide any 2 of the 3 main parameters (Power, Head, Flow Rate) and the calculator will determine the third. Perfect for design optimization and "what-if" scenarios.</p>
                <ul>
                    <li><strong>Design Power:</strong> Know your target capacity? Enter power and head to find required flow.</li>
                    <li><strong>Site Assessment:</strong> Know your site head and available flow? Calculate achievable power.</li>
                    <li><strong>Flow Analysis:</strong> Know power needs and flow rate? Determine required head.</li>
                </ul>
            </div>

            <!-- Basic Parameters -->
            <div class="input-section">
                <h2>Basic Design Parameters</h2>
                
                <div class="input-group">
                    <label for="desiredPower">Desired Power Capacity:</label>
                    <input type="number" id="desiredPower" step="0.1" min="0" placeholder="Leave blank to calculate from head & flow">
                    <select id="powerUnit" class="unit-select">
                        <option value="kW">kW</option>
                        <option value="MW">MW</option>
                    </select>
                </div>

                <div class="input-group">
                    <label for="flowRate">Flow Rate (Q):</label>
                    <input type="number" id="flowRate" step="0.1" min="0" placeholder="Leave blank to calculate from power & head">
                    <span id="flowUnit" class="unit-label">m¬≥/s</span>
                </div>

                <div class="input-group">
                    <label for="operationTime">Operation Duration:</label>
                    <input type="number" id="operationTime" step="0.1" min="0" placeholder="Hours of operation" value="8">
                    <span class="unit-label">hours</span>
                </div>

                <div class="input-group">
                    <label for="staticHead">Static Head (H):</label>
                    <input type="number" id="staticHead" step="0.1" min="0" placeholder="Leave blank to calculate from power & flow">
                    <span id="headUnit" class="unit-label">m</span>
                </div>

                <div class="input-group">
                    <label for="pumpEfficiency">Pump Efficiency:</label>
                    <input type="number" id="pumpEfficiency" step="0.01" min="0" max="1" value="0.85" placeholder="0.70 - 0.90">
                    <span class="unit-label">decimal (0.70-0.90)</span>
                </div>

                <div class="input-group">
                    <label for="turbineEfficiency">Turbine Efficiency:</label>
                    <input type="number" id="turbineEfficiency" step="0.01" min="0" max="1" value="0.90" placeholder="0.80 - 0.95">
                    <span class="unit-label">decimal (0.80-0.95)</span>
                </div>

                <div class="input-group">
                    <label for="generatorEfficiency">Generator/Motor Efficiency:</label>
                    <input type="number" id="generatorEfficiency" step="0.01" min="0" max="1" value="0.95" placeholder="0.90 - 0.98">
                    <span class="unit-label">decimal (0.90-0.98)</span>
                </div>
            </div>

            <!-- Additional Parameters (Collapsible) -->
            <div class="advanced-section">
                <h2 class="collapsible" id="advancedToggle">
                    Additional Parameters (Optional) 
                    <span class="toggle-icon">‚ñº</span>
                </h2>
                <div class="advanced-content" id="advancedContent">
                    <h3>Penstock Head Loss Analysis</h3>
                    <div class="input-group">
                        <label for="penstockLength">Penstock Length:</label>
                        <input type="number" id="penstockLength" step="1" min="0" placeholder="Optional - for pressure losses">
                        <span id="lengthUnit" class="unit-label">m</span>
                    </div>

                    <div class="input-group">
                        <label for="penstockDiameter">Penstock Diameter:</label>
                        <input type="number" id="penstockDiameter" step="0.1" min="0" placeholder="Optional - for pressure losses">
                        <span id="diameterUnit" class="unit-label">m</span>
                    </div>

                    <div class="input-group">
                        <label for="roughness">Penstock Roughness:</label>
                        <input type="number" id="roughness" step="0.001" min="0" value="0.0015" placeholder="Pipe roughness coefficient">
                        <span class="unit-label">mm</span>
                    </div>

                    <h3>Reservoir Configuration</h3>
                    <div class="reservoir-config">
                        <div class="config-options">
                            <label class="radio-container">
                                <input type="radio" name="reservoirType" value="fixed" checked>
                                <span class="checkmark"></span>
                                <div class="option-content">
                                    <strong>Fixed Reservoirs</strong>
                                    <p>Operations do not impact reservoir heights (large reservoirs)</p>
                                </div>
                            </label>
                            
                            <label class="radio-container">
                                <input type="radio" name="reservoirType" value="single-variable">
                                <span class="checkmark"></span>
                                <div class="option-content">
                                    <strong>Single Variable Reservoir</strong>
                                    <p>Operations impact either upper OR lower reservoir height</p>
                                </div>
                            </label>
                            
                            <label class="radio-container">
                                <input type="radio" name="reservoirType" value="dual-variable">
                                <span class="checkmark"></span>
                                <div class="option-content">
                                    <strong>Dual Variable Reservoirs</strong>
                                    <p>Operations impact BOTH upper AND lower reservoir heights</p>
                                </div>
                            </label>
                        </div>
                    </div>

                    <div id="reservoirInputs" class="reservoir-inputs">
                        <!-- Dynamic content based on reservoir type -->
                    </div>
                </div>
            </div>

            <!-- Calculate Button -->
            <div class="calculate-section">
                <button id="calculateBtn" class="calculate-btn">Calculate Pumped Storage System</button>
            </div>

            <!-- Results Section -->
            <div class="results-section">
                <h2>Calculation Results</h2>
                
                <div class="results-grid">
                    <div class="result-card">
                        <h3>Power Capacity</h3>
                        <div class="result-value" id="powerCapacity">-</div>
                        <div class="result-formula">P = œÅ √ó g √ó Q √ó H √ó Œ∑<sub>gen</sub></div>
                    </div>

                    <div class="result-card">
                        <h3>Static Head</h3>
                        <div class="result-value" id="staticHeadResult">-</div>
                        <div class="result-formula">H = P / (œÅ √ó g √ó Q √ó Œ∑<sub>gen</sub>)</div>
                    </div>

                    <div class="result-card">
                        <h3>Flow Rate</h3>
                        <div class="result-value" id="flowRateResult">-</div>
                        <div class="result-formula">Q = P / (œÅ √ó g √ó H √ó Œ∑<sub>gen</sub>)</div>
                    </div>

                    <div class="result-card">
                        <h3>Energy Storage Capacity</h3>
                        <div class="result-value" id="energyCapacity">-</div>
                        <div class="result-formula">E = œÅ √ó g √ó V √ó H √ó Œ∑<sub>total</sub></div>
                    </div>

                    <div class="result-card">
                        <h3>Reservoir Volume Required</h3>
                        <div class="result-value" id="reservoirVolume">-</div>
                        <div class="result-formula">V = Q √ó t<sub>operation</sub></div>
                    </div>

                    <div class="result-card">
                        <h3>Round-trip Efficiency</h3>
                        <div class="result-value" id="roundTripEfficiency">-</div>
                        <div class="result-formula">Œ∑<sub>RT</sub> = Œ∑<sub>pump</sub> √ó Œ∑<sub>turbine</sub> √ó Œ∑<sub>gen</sub>¬≤</div>
                    </div>
                </div>

                <!-- Interactive Charts Section -->
                <div class="charts-section">
                    <h3>Performance Analysis Charts</h3>
                    
                    <div class="charts-grid">
                        <div class="chart-container">
                            <h4>System Efficiency Breakdown</h4>
                            <canvas id="efficiencyChart" width="400" height="200"></canvas>
                        </div>
                        
                        <div class="chart-container">
                            <h4>Power vs. Head Relationship</h4>
                            <canvas id="powerHeadChart" width="400" height="200"></canvas>
                        </div>
                        
                        <div class="chart-container">
                            <h4>Energy Storage Duration</h4>
                            <canvas id="energyDurationChart" width="400" height="200"></canvas>
                        </div>
                        
                        <div class="chart-container">
                            <h4>Component Cost Distribution</h4>
                            <canvas id="costBenefitChart" width="400" height="200"></canvas>
                        </div>
                    </div>
                </div>

                <!-- Detailed Calculations -->
                <div class="calculations-section">
                    <h3>Step-by-Step Calculations</h3>
                    <div id="calculationSteps" class="calculation-steps">
                        <!-- Dynamic content -->
                    </div>
                </div>

                <!-- Unit Conversions -->
                <div class="conversion-section">
                    <h3>Unit Conversions</h3>
                    <div id="conversions" class="conversions-grid">
                        <!-- Dynamic content -->
                    </div>
                </div>
            </div>

            <!-- Educational Content -->
            <div class="education-section">
                <h2>Understanding Pumped Storage</h2>
                
                <div class="info-card">
                    <h3>How Pumped Storage Works</h3>
                    <p>Pumped storage hydropower (PSH) is a type of energy storage that uses the gravitational potential energy of water. During periods of low electricity demand, excess energy is used to pump water from a lower reservoir to an upper reservoir. When electricity is needed, water is released from the upper reservoir through turbines to generate electricity.</p>
                </div>

                <div class="info-card">
                    <h3>Key Design Considerations</h3>
                    <ul>
                        <li><strong>Head Height:</strong> The vertical distance between reservoirs - higher head means more energy density</li>
                        <li><strong>Reservoir Size:</strong> Determines energy storage capacity and operation duration</li>
                        <li><strong>Power Rating:</strong> Maximum power that can be generated or consumed during pumping</li>
                        <li><strong>Efficiency:</strong> Typical round-trip efficiencies range from 70-85%</li>
                        <li><strong>Response Time:</strong> PSH can respond to grid demands within seconds to minutes</li>
                    </ul>
                </div>

                <div class="info-card">
                    <h3>Efficiency Factors</h3>
                    <p><strong>Pump Mode:</strong> Œ∑<sub>pump</sub> √ó Œ∑<sub>motor</sub> = Overall pumping efficiency</p>
                    <p><strong>Generation Mode:</strong> Œ∑<sub>turbine</sub> √ó Œ∑<sub>generator</sub> = Overall generation efficiency</p>
                    <p><strong>Round-trip:</strong> Œ∑<sub>RT</sub> = Œ∑<sub>pumping</sub> √ó Œ∑<sub>generation</sub></p>
                </div>
            </div>
        </div>
    </div>

    <script src="pumped-storage-script.js"></script>
    <script src="pumped-storage-script.js"></script>
    </body>
</html>